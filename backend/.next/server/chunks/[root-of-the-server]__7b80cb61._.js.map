{"version":3,"sources":["../../../../backend/src/lib/prisma.ts","../../../../backend/src/lib/validations/schemas.ts","../../../../backend/src/lib/request-id.ts","../../../../backend/src/lib/ai/resolve.ts","../../../../backend/src/lib/web-search/serper.ts","../../../../backend/src/lib/web-search/resolve.ts","../../../../backend/src/lib/gemini.ts","../../../../node_modules/next/dist/esm/build/templates/app-route.js","../../../../backend/src/app/api/v1/analyze/route.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\n\nexport const prisma =\n    globalForPrisma.prisma ||\n    new PrismaClient({\n        log: ['error'],\n    });\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\n","import { z } from 'zod';\n\n/** POST /api/auth/register */\nexport const registerSchema = z.object({\n  email: z.string().email('Invalid email').transform((s) => s.trim().toLowerCase()),\n  password: z.string().min(8, 'Password must be at least 8 characters'),\n  name: z.string().max(200).optional().transform((s) => (s?.trim() || undefined)),\n});\n\n/** POST /api/onboarding/complete */\nexport const onboardingCompleteSchema = z.object({\n  companyName: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  productService: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  targetAudience: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  mainBenefit: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n});\n\n/** POST /api/search ‚Äî city/state/country/radiusKm for locationBias (Places API) */\nexport const searchSchema = z.object({\n  textQuery: z.string().min(1, 'textQuery is required').max(500),\n  includedType: z.string().max(100).optional(),\n  pageSize: z.coerce.number().int().min(1).max(100).optional(),\n  pageToken: z.string().optional(),\n  hasWebsite: z.enum(['yes', 'no']).optional(),\n  hasPhone: z.enum(['yes', 'no']).optional(),\n  city: z.string().max(200).optional(),\n  state: z.string().max(100).optional(),\n  country: z.string().max(100).optional(),\n  radiusKm: z.coerce.number().min(1).max(100).optional(),\n});\n\n/** POST /api/market-report */\nexport const marketReportSchema = z.object({\n  textQuery: z.string().min(1, 'textQuery is required').max(500),\n  includedType: z.string().max(100).optional(),\n  pageSize: z.coerce.number().int().min(1).max(60).optional(),\n  city: z.string().max(200).optional(),\n  state: z.string().max(100).optional(),\n});\n\n/** POST /api/analyze ‚Äî full place data improves precision (website, address, reviews). */\nexport const analyzeSchema = z.object({\n  placeId: z.string().min(1, 'placeId is required'),\n  name: z.string().min(1, 'Business name is required'),\n  userProfile: z.record(z.string(), z.unknown()).optional(),\n  locale: z.string().optional(),\n  websiteUri: z.string().optional(),\n  website: z.string().optional(),\n  formattedAddress: z.string().optional(),\n  address: z.string().optional(),\n  nationalPhoneNumber: z.string().optional(),\n  internationalPhoneNumber: z.string().optional(),\n  phone: z.string().optional(),\n  rating: z.number().optional(),\n  userRatingCount: z.number().optional(),\n  reviewCount: z.number().optional(),\n  types: z.array(z.string()).optional(),\n  primaryType: z.string().optional(),\n  businessStatus: z.string().optional(),\n  reviews: z.array(z.object({\n    rating: z.number(),\n    text: z.object({ text: z.string() }).optional(),\n    authorAttribution: z.object({ displayName: z.string() }).optional(),\n    relativePublishTimeDescription: z.string().optional(),\n  })).optional(),\n});\n\n/** POST /api/user/profile (personal profile only) */\nexport const profileSchema = z.object({\n  name: z.string().max(200).optional().transform((s) => (s?.trim() || undefined)),\n  phone: z.string().max(50).optional().transform((s) => (s?.trim() || undefined)),\n  address: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  linkedInUrl: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  instagramUrl: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  facebookUrl: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  websiteUrl: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  image: z.string().max(2000).optional().transform((s) => (s?.trim() || undefined)),\n  notifyByEmail: z.boolean().optional(),\n  notifyWeeklyReport: z.boolean().optional(),\n  notifyLeadAlerts: z.boolean().optional(),\n});\n\n/** POST /api/company-analysis ‚Äî useProfile (default true) + optional overrides (defaults from workspace when useProfile) */\nexport const companyAnalysisSchema = z.object({\n  useProfile: z.boolean().optional().default(true),\n  companyName: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  city: z.string().max(200).optional().transform((s) => (s?.trim() || undefined)),\n  state: z.string().max(100).optional().transform((s) => (s?.trim() || undefined)),\n  productService: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  targetAudience: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  mainBenefit: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  address: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  websiteUrl: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  linkedInUrl: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  instagramUrl: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  facebookUrl: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n});\n\n/** PATCH /api/workspace/current/profile (workspace/company profile) */\nexport const workspaceProfileSchema = z.object({\n  companyName: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  productService: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  targetAudience: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  mainBenefit: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  address: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  linkedInUrl: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  instagramUrl: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  facebookUrl: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  websiteUrl: z.string().max(500).optional().transform((s) => (s?.trim() || undefined)),\n  logoUrl: z.string().max(2000).optional().transform((s) => (s?.trim() || undefined)),\n});\n\n/** POST /api/billing/checkout and /api/v1/billing/checkout */\nexport const checkoutSchema = z.object({\n  planId: z.string().min(1, 'planId is required'),\n  locale: z.string().max(10).optional(),\n  cycle: z.enum(['monthly', 'annual']).optional(),\n  interval: z.enum(['monthly', 'annual']).optional(),\n  /** Mercado Pago card token (for recurring subscription with card). Omit for PIX/boleto (Preference). */\n  card_token_id: z.string().max(500).optional(),\n  /** If true and current plan > target plan, schedule downgrade at period end instead of creating new checkout. */\n  scheduleAtPeriodEnd: z.boolean().optional(),\n});\n\n/** POST /api/billing/schedule-downgrade ‚Äî schedule plan change at end of current period (no immediate charge). */\nexport const scheduleDowngradeSchema = z.object({\n  planId: z.enum(['FREE', 'BASIC', 'PRO', 'BUSINESS', 'SCALE'], { message: 'planId must be a valid plan key' }),\n});\n\n/** POST /api/billing/process-payment (Mercado Pago) */\nexport const processPaymentSchema = z.object({\n  token: z.string().min(1, 'token is required'),\n  issuer_id: z.string().optional(),\n  payment_method_id: z.string().min(1, 'payment_method_id is required'),\n  transaction_amount: z.coerce.number().positive('transaction_amount must be positive'),\n  installments: z.number().int().min(1).optional(),\n  payer: z.object({\n    email: z.string().email().optional(),\n    identification: z.object({ type: z.string().optional(), number: z.string().optional() }).optional(),\n  }).optional(),\n  planId: z.string().min(1, 'planId is required'),\n  interval: z.enum(['monthly', 'annual']),\n});\n\n/** Admin list endpoints: query params limit, offset, workspaceId (optional filter) */\nexport const adminListQuerySchema = z.object({\n  limit: z.coerce.number().int().min(1).max(100).optional(),\n  offset: z.coerce.number().int().min(0).optional(),\n  workspaceId: z.string().min(1).optional(),\n});\n\n/** Support users list: limit, offset, search (name/email) */\nexport const supportUsersListSchema = z.object({\n  limit: z.coerce.number().int().min(1).max(100).optional(),\n  offset: z.coerce.number().int().min(0).optional(),\n  search: z.string().min(1).max(200).optional(),\n});\n\n/** PATCH /api/support/users/[id]/deactivate body */\nexport const supportDeactivateSchema = z.object({\n  reason: z.string().max(500).optional(),\n});\n\n/** POST /api/admin/users/[id]/reset-password and /api/support/users/[id]/reset-password */\nexport const adminResetPasswordSchema = z.object({\n  sendEmail: z.boolean().optional(),\n  temporaryPassword: z.string().min(8, 'Password must be at least 8 characters').optional(),\n}).refine((d) => d.sendEmail === true || (d.temporaryPassword != null && d.temporaryPassword.length >= 8), {\n  message: 'Either sendEmail true or temporaryPassword (min 8 chars) is required',\n});\n\n/** PATCH /api/admin/workspaces/[id] */\nexport const adminWorkspaceUpdateSchema = z.object({\n  plan: z.enum(['FREE', 'BASIC', 'PRO', 'BUSINESS', 'SCALE']).optional(),\n  leadsLimit: z.coerce.number().int().min(0).optional(),\n});\n\n/** POST /api/team/invite */\nexport const teamInviteSchema = z.object({\n  email: z.string().email('Valid email is required').transform((s) => s.trim().toLowerCase()),\n});\n\n/** POST /api/auth/forgot-password */\nexport const forgotSchema = z.object({\n  email: z.string().min(1, 'Email is required').email('Invalid email address'),\n});\n\n/** POST /api/auth/reset-password */\nexport const resetSchema = z.object({\n  token: z.string().min(1, 'Token and password are required'),\n  password: z.string().min(8, 'Password must be at least 8 characters'),\n});\n\n/** POST /api/auth/2fa/verify and disable ‚Äî TOTP code */\nexport const twoFaCodeSchema = z.object({\n  code: z.string().length(6, 'Code must be 6 digits').regex(/^\\d{6}$/, 'Code must be 6 digits'),\n});\n\n/** GET /api/details ‚Äî query param */\nexport const detailsQuerySchema = z.object({\n  placeId: z.string().min(1, 'placeId is required'),\n});\n\n/** GET /api/export/leads ‚Äî query params */\nexport const exportLeadsQuerySchema = z.object({\n  format: z.enum(['json', 'csv']).optional(),\n});\n\n/** GET /api/search/history ‚Äî query params */\nexport const searchHistoryQuerySchema = z.object({\n  limit: z.coerce.number().int().min(1).max(100).optional(),\n  offset: z.coerce.number().int().min(0).optional(),\n});\n\n/** PATCH /api/leads/[id] ‚Äî body (at least one of status or isFavorite) */\nexport const leadStatusSchema = z\n  .object({\n    status: z.enum(['NEW', 'CONTACTED', 'CONVERTED', 'LOST']).optional(),\n    isFavorite: z.boolean().optional(),\n  })\n  .refine((d) => d.status !== undefined || d.isFavorite !== undefined, {\n    message: 'At least one of status or isFavorite is required',\n  });\n\n/** DELETE /api/team/remove ‚Äî body */\nexport const teamRemoveSchema = z.object({\n  userIdToRemove: z.string().min(1, 'User ID to remove is required'),\n});\n\n/** POST /api/v1/analyze ‚Äî same as analyze plus optional userId for external callers */\nexport const v1AnalyzeSchema = analyzeSchema.extend({\n  userId: z.string().optional(),\n});\n\n/** POST /api/admin/ai-config ‚Äî create AI provider config */\nexport const aiConfigCreateSchema = z.object({\n  role: z.enum(['lead_analysis', 'viability']),\n  provider: z.enum(['GEMINI', 'OPENAI', 'CLOUDFLARE']),\n  model: z.string().min(1).max(200),\n  apiKey: z.string().optional(),\n  cloudflareAccountId: z.string().max(100).optional(),\n  enabled: z.boolean().optional().default(true),\n});\n\n/** PATCH /api/admin/ai-config/[id] ‚Äî update AI provider config */\nexport const aiConfigUpdateSchema = z.object({\n  role: z.enum(['lead_analysis', 'viability']).optional(),\n  provider: z.enum(['GEMINI', 'OPENAI', 'CLOUDFLARE']).optional(),\n  model: z.string().min(1).max(200).optional(),\n  apiKey: z.string().optional(),\n  cloudflareAccountId: z.string().max(100).optional().nullable(),\n  enabled: z.boolean().optional(),\n});\n\n/** PATCH /api/admin/web-search-config ‚Äî upsert web search config by role */\nexport const webSearchConfigSchema = z.object({\n  role: z.enum(['lead_analysis', 'viability']),\n  provider: z.enum(['SERPER', 'TAVILY']),\n  apiKey: z.string().optional(),\n  maxResults: z.number().int().min(1).max(20).optional().default(5),\n  enabled: z.boolean().optional().default(true),\n});\n\n/** Returns first Zod error message for 400 responses */\nexport function formatZodError(\n  result: { success: false; error: z.ZodError }\n): string {\n  const first = result.error.issues[0];\n  return first ? `${first.path.join('.') || 'body'}: ${first.message}` : 'Validation failed';\n}\n\nexport type RegisterInput = z.infer<typeof registerSchema>;\nexport type OnboardingCompleteInput = z.infer<typeof onboardingCompleteSchema>;\nexport type SearchInput = z.infer<typeof searchSchema>;\nexport type AnalyzeInput = z.infer<typeof analyzeSchema>;\nexport type ProfileInput = z.infer<typeof profileSchema>;\nexport type CheckoutInput = z.infer<typeof checkoutSchema>;\nexport type ProcessPaymentInput = z.infer<typeof processPaymentSchema>;\nexport type AdminListQuery = z.infer<typeof adminListQuerySchema>;\nexport type TeamInviteInput = z.infer<typeof teamInviteSchema>;\nexport type ForgotInput = z.infer<typeof forgotSchema>;\nexport type ResetInput = z.infer<typeof resetSchema>;\nexport type TwoFaCodeInput = z.infer<typeof twoFaCodeSchema>;\nexport type ExportLeadsQuery = z.infer<typeof exportLeadsQuerySchema>;\nexport type DetailsQuery = z.infer<typeof detailsQuerySchema>;\nexport type SearchHistoryQuery = z.infer<typeof searchHistoryQuerySchema>;\nexport type LeadStatusInput = z.infer<typeof leadStatusSchema>;\nexport type TeamRemoveInput = z.infer<typeof teamRemoveSchema>;\nexport type V1AnalyzeInput = z.infer<typeof v1AnalyzeSchema>;\nexport type AiConfigCreateInput = z.infer<typeof aiConfigCreateSchema>;\nexport type AiConfigUpdateInput = z.infer<typeof aiConfigUpdateSchema>;\nexport type WebSearchConfigInput = z.infer<typeof webSearchConfigSchema>;\n","import { NextResponse } from 'next/server';\nimport crypto from 'crypto';\n\n/**\n * Obt√©m o requestId do header x-request-id ou gera um novo (para rastreabilidade).\n * Se req n√£o for passado (ex.: health), gera um id novo.\n */\nexport function getOrCreateRequestId(req?: { headers?: { get: (name: string) => string | null } } | null): string {\n  if (!req?.headers?.get) return crypto.randomUUID();\n  const id = req.headers.get('x-request-id')?.trim();\n  return id && id.length > 0 ? id : crypto.randomUUID();\n}\n\n/**\n * Retorna NextResponse.json com header x-request-id para correla√ß√£o cliente-servidor.\n */\nexport function jsonWithRequestId<T>(\n  data: T,\n  init: { status?: number; requestId: string }\n): NextResponse {\n  const res = NextResponse.json(data, { status: init.status ?? 200 });\n  res.headers.set('x-request-id', init.requestId);\n  return res;\n}\n","/**\n * Resolves AI config by role: DB first, then env fallback (GEMINI_API_KEY).\n */\nimport { createGeminiAdapter } from './adapters/gemini';\nimport { createOpenAIAdapter } from './adapters/openai';\nimport { createCloudflareAdapter } from './adapters/cloudflare';\nimport type { AiRole, AiProviderType, CompletionOptions, CompletionResult, IAIAdapter, ResolvedAiConfig } from './types';\n\nconst DEFAULT_MODEL_BY_ROLE: Record<AiRole, string> = {\n    lead_analysis: 'gemini-flash-latest',\n    viability: 'gemini-2.5-flash',\n    company_analysis: 'gemini-2.5-flash',\n};\n\n/**\n * Returns resolved config and adapter for the given role.\n * Uses DB (AiProviderConfig no painel admin) first; se n√£o houver config para o role,\n * viability usa o mesmo config de lead_analysis (mesmo provedor/modelo da busca).\n * Sen√£o fallback env (GEMINI_API_KEY).\n */\nexport async function resolveAiForRole(role: AiRole): Promise<{ config: ResolvedAiConfig; adapter: IAIAdapter }> {\n    let fromDb = await getAiConfigFromDb(role);\n    if (!fromDb && (role === 'viability' || role === 'company_analysis')) {\n        fromDb = await getAiConfigFromDb(role === 'company_analysis' ? 'viability' : 'lead_analysis');\n    }\n    if (fromDb) {\n        const adapter = createAdapter(fromDb.provider, fromDb.model, fromDb.apiKey, fromDb.accountId);\n        return { config: { provider: fromDb.provider, model: fromDb.model, apiKey: fromDb.apiKey }, adapter };\n    }\n\n    const apiKey = process.env.GEMINI_API_KEY;\n    if (!apiKey) throw new Error(`No AI config for role \"${role}\" and GEMINI_API_KEY not set`);\n    const model = DEFAULT_MODEL_BY_ROLE[role];\n    const adapter = createGeminiAdapter(apiKey, model);\n    return {\n        config: { provider: 'GEMINI', model, apiKey },\n        adapter,\n    };\n}\n\n/**\n * Single entry point for completion: resolve by role and run.\n */\nexport async function generateCompletionForRole(\n    role: AiRole,\n    options: CompletionOptions\n): Promise<CompletionResult> {\n    const { adapter } = await resolveAiForRole(role);\n    return adapter.generateCompletion(options);\n}\n\ninterface DbConfig {\n    provider: AiProviderType;\n    model: string;\n    apiKey: string;\n    accountId?: string;\n}\n\nconst ROLE_TO_PRISMA: Record<AiRole, 'LEAD_ANALYSIS' | 'VIABILITY' | 'COMPANY_ANALYSIS'> = {\n    lead_analysis: 'LEAD_ANALYSIS',\n    viability: 'VIABILITY',\n    company_analysis: 'COMPANY_ANALYSIS',\n};\n\nasync function getAiConfigFromDb(role: AiRole): Promise<DbConfig | null> {\n    try {\n        const { prisma } = await import('@/lib/prisma');\n        const { decryptApiKey } = await import('@/lib/ai/encrypt');\n        const prismaRole = ROLE_TO_PRISMA[role];\n        const row = await prisma.aiProviderConfig.findFirst({\n            where: { role: prismaRole, enabled: true },\n            orderBy: { updatedAt: 'desc' },\n        });\n        if (!row || !row.apiKeyEncrypted) return null;\n        const apiKey = decryptApiKey(row.apiKeyEncrypted);\n        return {\n            provider: row.provider as AiProviderType,\n            model: row.model,\n            apiKey,\n            accountId: row.cloudflareAccountId ?? undefined,\n        };\n    } catch {\n        return null;\n    }\n}\n\nfunction createAdapter(\n    provider: AiProviderType,\n    model: string,\n    apiKey: string,\n    accountId?: string\n): IAIAdapter {\n    switch (provider) {\n        case 'GEMINI':\n            return createGeminiAdapter(apiKey, model);\n        case 'OPENAI':\n            return createOpenAIAdapter(apiKey, model);\n        case 'CLOUDFLARE':\n            return createCloudflareAdapter(apiKey, model, accountId);\n        default:\n            throw new Error(`Unknown AI provider: ${provider}`);\n    }\n}\n","/**\n * Serper.dev search adapter.\n * POST https://google.serper.dev/search with X-API-KEY header.\n */\n\nconst SERPER_URL = 'https://google.serper.dev/search';\n\nexport interface SerperResult {\n  title: string;\n  link: string;\n  snippet?: string;\n}\n\nexport async function searchSerper(\n  apiKey: string,\n  query: string,\n  num: number = 5\n): Promise<SerperResult[]> {\n  const res = await fetch(SERPER_URL, {\n    method: 'POST',\n    headers: {\n      'X-API-KEY': apiKey,\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({ q: query, num }),\n  });\n  if (!res.ok) {\n    const errText = await res.text();\n    throw new Error(`Serper API error ${res.status}: ${errText}`);\n  }\n  const data = (await res.json()) as {\n    organic?: Array<{ title?: string; link?: string; snippet?: string }>;\n  };\n  const organic = data.organic ?? [];\n  return organic.slice(0, num).map((o) => ({\n    title: o.title ?? '',\n    link: o.link ?? '',\n    snippet: o.snippet,\n  }));\n}\n","/**\n * Resolves web search config by role and runs search queries.\n * Returns aggregated context text for injection into AI prompt.\n *\n * Results are grouped by source (Reclame Aqui, JusBrasil, CNPJ, etc.)\n * so the AI can clearly identify and cite each data source.\n */\n\nimport type { AiRole } from '@/lib/ai/types';\nimport { searchSerper } from './serper';\n\nconst ROLE_TO_PRISMA = {\n    lead_analysis: 'LEAD_ANALYSIS' as const,\n    viability: 'VIABILITY' as const,\n    company_analysis: 'COMPANY_ANALYSIS' as const,\n};\n\n/**\n * Fetch web search config for role (enabled, with key). Returns null if not configured.\n */\nasync function getWebSearchConfig(role: AiRole): Promise<{\n    provider: string;\n    apiKey: string;\n    maxResults: number;\n} | null> {\n    try {\n        const { prisma } = await import('@/lib/prisma');\n        const { decryptApiKey } = await import('@/lib/ai/encrypt');\n        const prismaRole = ROLE_TO_PRISMA[role];\n        const row = await prisma.webSearchConfig.findUnique({\n            where: { role: prismaRole },\n        });\n        if (!row || !row.enabled || !row.apiKeyEncrypted) return null;\n        const apiKey = decryptApiKey(row.apiKeyEncrypted);\n        return {\n            provider: row.provider,\n            apiKey,\n            maxResults: row.maxResults ?? 5,\n        };\n    } catch {\n        return null;\n    }\n}\n\nexport interface GetWebContextOptions {\n    workspaceId?: string;\n    userId?: string;\n}\n\ninterface SearchSection {\n    label: string;\n    emoji: string;\n    items: Array<{ title: string; link: string; snippet: string }>;\n}\n\n/**\n * Infer a human-readable section label + emoji from the query string.\n * This allows the AI to see exactly which data source each result came from.\n */\nfunction inferSectionLabel(query: string): { label: string; emoji: string } {\n    const q = query.toLowerCase();\n    if (q.includes('reclame aqui')) return { label: 'Reclame Aqui ‚Äî Reputa√ß√£o do Consumidor', emoji: 'üî¥' };\n    if (q.includes('jusbrasil')) return { label: 'JusBrasil ‚Äî Processos Judiciais', emoji: '‚öñÔ∏è' };\n    if (q.includes('cnpj')) return { label: 'CNPJ ‚Äî Dados Empresariais', emoji: 'üè¢' };\n    if (q.includes('instagram')) return { label: 'Redes sociais ‚Äî Instagram', emoji: 'üì±' };\n    if (q.includes('facebook')) return { label: 'Redes sociais ‚Äî Facebook', emoji: 'üì±' };\n    if (q.includes('linkedin')) return { label: 'Redes sociais ‚Äî LinkedIn', emoji: 'üì±' };\n    if (q.includes('avalia√ß√µes google') || q.includes('google reviews'))\n        return { label: 'Avalia√ß√µes Google', emoji: '‚≠ê' };\n    return { label: `Busca Web ‚Äî \"${query}\"`, emoji: 'üîç' };\n}\n\n/**\n * Format grouped sections into structured Markdown for injection into AI prompt.\n */\nfunction formatSections(sections: SearchSection[]): string {\n    const parts: string[] = [];\n    for (const section of sections) {\n        if (section.items.length === 0) continue;\n        parts.push(`### ${section.emoji} ${section.label}`);\n        for (const item of section.items) {\n            parts.push(`- **${item.title}** ‚Äî [${item.link}](${item.link})`);\n            if (item.snippet) {\n                parts.push(`  ${item.snippet}`);\n            }\n        }\n        parts.push(''); // blank line between sections\n    }\n    return parts.join('\\n');\n}\n\n/**\n * Run search for each query and return a single context block with labeled sections.\n * Each query generates its own section (Reclame Aqui, JusBrasil, CNPJ, etc.).\n * Returns empty string if no config or no results.\n */\nexport async function getWebContextForRole(\n    role: AiRole,\n    queries: string[],\n    options?: GetWebContextOptions\n): Promise<string> {\n    const config = await getWebSearchConfig(role);\n    if (!config || queries.length === 0) return '';\n\n    const sections: SearchSection[] = [];\n    let serperQueryCount = 0;\n\n    const maxQueries = role === 'company_analysis' ? 6 : 5;\n    for (const q of queries.slice(0, maxQueries)) {\n        if (!q.trim()) continue;\n        const { label, emoji } = inferSectionLabel(q);\n        const section: SearchSection = { label, emoji, items: [] };\n\n        try {\n            if (config.provider === 'SERPER') {\n                const items = await searchSerper(config.apiKey, q.trim(), Math.min(config.maxResults, 5));\n                serperQueryCount += 1;\n                for (const item of items) {\n                    section.items.push({\n                        title: item.title,\n                        link: item.link,\n                        snippet: item.snippet ?? '',\n                    });\n                }\n            }\n            // TAVILY: adapter not implemented yet; skip query\n        } catch {\n            // skip failed query\n        }\n\n        sections.push(section);\n    }\n\n    if (options?.workspaceId && serperQueryCount > 0) {\n        const { recordUsageEvent } = await import('@/lib/usage');\n        recordUsageEvent({\n            workspaceId: options.workspaceId,\n            userId: options.userId ?? undefined,\n            type: 'SERPER_REQUEST',\n            quantity: serperQueryCount,\n        });\n    }\n\n    const formattedSections = formatSections(sections);\n    if (!formattedSections.trim()) return '';\n\n    return `## üìä Contexto da Web (dados reais coletados ‚Äî use-os na an√°lise e cite as fontes)\\n\\n${formattedSections}`;\n}\n","import { generateCompletionForRole } from '@/lib/ai';\nimport { getWebContextForRole } from '@/lib/web-search/resolve';\nimport { prisma } from './prisma';\n\nexport interface LeadAnalysis {\n    score: number;\n    scoreLabel: string;\n    summary: string;\n    strengths: string[];\n    weaknesses: string[];\n    painPoints: string[];\n    gaps: string[];\n    approach: string;\n    contactStrategy: string;\n    firstContactMessage: string;\n    suggestedWhatsAppMessage: string;\n    reviewAnalysis?: string;\n    socialMedia?: {\n        instagram?: string;\n        facebook?: string;\n        linkedin?: string;\n    };\n    fullReport: string;\n    /** Deep analysis fields ‚Äî only populated for BUSINESS/SCALE plans */\n    reclameAquiAnalysis?: string;\n    jusBrasilAnalysis?: string;\n    cnpjAnalysis?: string;\n}\n\nexport interface UserBusinessProfile {\n    companyName: string;\n    productService: string;\n    targetAudience: string;\n    mainBenefit: string;\n}\n\nexport interface BusinessData {\n    placeId: string;\n    name: string;\n    formattedAddress?: string;\n    address?: string;\n    nationalPhoneNumber?: string;\n    internationalPhoneNumber?: string;\n    phone?: string;\n    websiteUri?: string;\n    website?: string;\n    rating?: number;\n    userRatingCount?: number;\n    reviewCount?: number;\n    types?: string[];\n    businessStatus?: string;\n    primaryType?: string;\n    hasOpeningHours?: boolean;\n    reviews?: Array<{\n        rating: number;\n        text: { text: string };\n        authorAttribution: { displayName: string };\n        relativePublishTimeDescription: string;\n    }>;\n}\n\nexport interface AnalyzeLeadContext {\n    workspaceId: string;\n    userId?: string;\n}\n\nexport async function analyzeLead(\n    business: BusinessData,\n    userProfile?: UserBusinessProfile,\n    locale: string = 'pt',\n    userId?: string,\n    isBusinessPlan: boolean = false,\n    context?: AnalyzeLeadContext\n): Promise<{ analysis: LeadAnalysis; usage?: { inputTokens: number; outputTokens: number }; provider?: string }> {\n    let finalProfile = userProfile;\n    if (!finalProfile && userId) {\n        const user = await prisma.user.findUnique({ where: { id: userId } });\n        if (user && user.companyName) {\n            finalProfile = {\n                companyName: user.companyName,\n                productService: user.productService || '',\n                targetAudience: user.targetAudience || '',\n                mainBenefit: user.mainBenefit || ''\n            };\n        }\n    }\n    // Treat as \"no profile\" when company and product are empty so we don't pass ambiguous context\n    if (finalProfile && !finalProfile.companyName?.trim() && !finalProfile.productService?.trim()) {\n        finalProfile = undefined;\n    }\n\n    const isEn = locale === 'en';\n\n    const address = business.formattedAddress || business.address || '';\n    const cityPart = address ? address.split(',').pop()?.trim() : '';\n    const webQueries = [\n        business.name,\n        `Reclame Aqui ${business.name}`,\n        `CNPJ ${business.name} ${cityPart}`.trim(),\n        `JusBrasil ${business.name}`,\n        business.primaryType || business.types?.[0] || '',\n    ].filter(Boolean);\n    const webContext = await getWebContextForRole('lead_analysis', webQueries, context ? { workspaceId: context.workspaceId, userId: context.userId } : undefined);\n\n    const phone = business.nationalPhoneNumber || business.internationalPhoneNumber || business.phone || '';\n    const website = business.websiteUri || business.website || '';\n    const reviewCount = business.userRatingCount || business.reviewCount || 0;\n\n    // Format reviews for analysis\n    const reviewsText = business.reviews && business.reviews.length > 0\n        ? business.reviews.slice(0, 5).map(r =>\n            `[${r.rating}/5 - ${r.authorAttribution?.displayName || 'Client'}]: \"${r.text?.text?.slice(0, 200)}\"`\n        ).join('\\n')\n        : (isEn ? 'No recent reviews available' : 'Nenhuma avalia√ß√£o recente dispon√≠vel');\n\n    const companyContext = finalProfile\n        ? (isEn\n            ? `You are a Senior B2B Commercial Consultant for \"${finalProfile.companyName}\".\n\"${finalProfile.companyName}\" offers: \"${finalProfile.productService}\".\nTarget audience: \"${finalProfile.targetAudience}\".\nMain competitive advantage: \"${finalProfile.mainBenefit}\".\nCRUCIAL CONTEXT: Analyze the \"website\" gap through the lens of YOUR product (\"${finalProfile.productService}\"). If you sell websites/marketing, a missing website is a massive sales opportunity. If you sell Insurance, Cleaning, Logistics, Real Estate, or other physical/B2B services, a missing website is just a minor communication detail, NOT a critical flaw.\nMANDATORY: The ENTIRE report (summary, strengths, weaknesses, gaps, painPoints, approachStrategy, suggestedScripts, fullReport) must be from the perspective of \"${finalProfile.companyName}\" selling ONLY \"${finalProfile.productService}\". Do NOT recommend or offer services that are not what this company sells (e.g. if they sell real estate, do NOT suggest offering websites, SEO, or digital marketing to the lead; suggest only real estate services such as finding space, listings, rentals).`\n            : `Voc√™ √© um Consultor Comercial B2B S√™nior trabalhando para \"${finalProfile.companyName}\".\n\"${finalProfile.companyName}\" oferece: \"${finalProfile.productService}\".\nP√∫blico-alvo: \"${finalProfile.targetAudience}\".\nPrincipal diferencial: \"${finalProfile.mainBenefit}\".\nCONTEXTO CRUCIAL: Analise a lacuna de \"website\" atrav√©s da lente do SEU produto (\"${finalProfile.productService}\"). Se voc√™ vende sites/marketing, a falta de um site √© uma enorme oportunidade de venda. Se voc√™ vende Seguros, Limpeza, Log√≠stica, Imobili√°ria ou outros servi√ßos f√≠sicos/B2B, a falta de um site √© apenas um detalhe de comunica√ß√£o menor, N√ÉO uma falha cr√≠tica.\nOBRIGAT√ìRIO: O relat√≥rio INTEIRO (resumo, pontos fortes, fraquezas, lacunas, dores, estrat√©gia de abordagem, scripts sugeridos, relat√≥rio completo) deve ser na perspectiva de \"${finalProfile.companyName}\" vendendo APENAS \"${finalProfile.productService}\". N√ÉO recomende nem ofere√ßa servi√ßos que n√£o sejam o que esta empresa vende (ex.: se for imobili√°ria, N√ÉO sugira oferecer site, SEO ou marketing digital ao lead; sugira apenas servi√ßos imobili√°rios como encontrar espa√ßo, im√≥veis para loca√ß√£o/venda).`)\n        : (isEn\n            ? `You are a Senior B2B Strategic Consultant specialized in commercial prospecting.`\n            : `Voc√™ √© um Consultor Estrat√©gico B2B S√™nior especializado em prospec√ß√£o comercial.`);\n\n    const prompt = `${companyContext}\n\n${isEn\n            ? `Your task is to generate a DEEP, DETAILED, and ACTIONABLE strategic prospecting report for the lead below.\nBe like a senior consultant who has researched this company thoroughly. Avoid generic statements.\nEvery insight must be specific to THIS business and how YOUR product/service can help them.`\n            : `Sua tarefa √© gerar um relat√≥rio estrat√©gico de prospec√ß√£o PROFUNDO, DETALHADO e ACION√ÅVEL para o lead abaixo.\nSeja como um consultor s√™nior que pesquisou a fundo esta empresa. Evite afirma√ß√µes gen√©ricas.\nCada an√°lise deve ser espec√≠fica para ESTE neg√≥cio e como o SEU produto/servi√ßo pode ajud√°-los.`}\n\n${isEn ? 'LEAD DATA:' : 'DADOS DO LEAD:'}\n- ${isEn ? 'Business Name' : 'Nome do Neg√≥cio'}: ${business.name}\n- ${isEn ? 'Type/Category' : 'Tipo/Categoria'}: ${business.primaryType || business.types?.join(', ') || (isEn ? 'Not specified' : 'N√£o especificado')}\n- ${isEn ? 'Address' : 'Endere√ßo'}: ${address || (isEn ? 'Not available' : 'N√£o dispon√≠vel')}\n- ${isEn ? 'Phone' : 'Telefone'}: ${phone || (isEn ? 'No phone listed' : 'Sem telefone cadastrado')}\n- ${isEn ? 'Website' : 'Website'}: ${website ? website : (isEn ? 'NO WEBSITE (critical gap)' : 'SEM WEBSITE (lacuna cr√≠tica)')}\n- ${isEn ? 'Google Rating' : 'Avalia√ß√£o Google'}: ${business.rating ?? (isEn ? 'No rating' : 'Sem avalia√ß√£o')}/5\n- ${isEn ? 'Total Reviews' : 'Total de Avalia√ß√µes'}: ${reviewCount}\n- ${isEn ? 'Business Status' : 'Status do Neg√≥cio'}: ${business.businessStatus || 'OPERATIONAL'}\n${website\n            ? (isEn\n                ? '\\nCRITICAL: This lead HAS a website (URL above). You MUST acknowledge it, analyze it when relevant (content, UX, SEO, gaps in the site itself), and NEVER list \"no website\" or \"missing website\" as a gap.'\n                : '\\nCR√çTICO: Este lead POSSUI website (URL acima). Voc√™ DEVE reconhec√™-lo, analis√°-lo quando relevante (conte√∫do, UX, SEO, lacunas no pr√≥prio site) e NUNCA listar \"sem website\" ou \"aus√™ncia de site\" como lacuna.')\n            : ''}\n\n${isEn ? 'RECENT CUSTOMER REVIEWS:' : 'AVALIA√á√ïES RECENTES DE CLIENTES:'}\n${reviewsText}\n${webContext ? `\\n\\n${webContext}\\n${isBusinessPlan\n            ? (isEn\n                ? '\\nIMPORTANT: The web context above contains REAL data collected from Reclame Aqui, JusBrasil, CNPJ databases, and general web searches. You MUST analyze this data carefully and incorporate it into your report. Cite specific findings and sources. If Reclame Aqui shows complaints, detail them. If JusBrasil shows lawsuits, flag the risks. If CNPJ data reveals information about the company, use it.'\n                : '\\nIMPORTANTE: O contexto da web acima cont√©m dados REAIS coletados do Reclame Aqui, JusBrasil, bases de CNPJ e buscas web gerais. Voc√™ DEVE analisar esses dados cuidadosamente e incorpor√°-los ao seu relat√≥rio. Cite achados e fontes espec√≠ficas. Se o Reclame Aqui mostra reclama√ß√µes, detalhe-as. Se o JusBrasil mostra processos, sinalize os riscos. Se dados de CNPJ revelam informa√ß√µes sobre a empresa, use-os.')\n            : ''}\\n\\n` : ''}\n\n${isEn ? 'ANALYSIS REQUIREMENTS (be extremely specific, not generic):' : 'REQUISITOS DA AN√ÅLISE (seja extremamente espec√≠fico, n√£o gen√©rico):'}\n\n1. ${isEn ? 'DIGITAL PRESENCE GAPS: What is this business missing? (website, online booking, e-commerce, CRM, social media management, paid ads, SEO, etc.) Consider if missing a website is actually a problem for them based on what YOU sell.' : 'LACUNAS DE PRESEN√áA DIGITAL: O que este neg√≥cio est√° faltando? (website, agendamento online, e-commerce, CRM, gest√£o de redes sociais, an√∫ncios pagos, SEO, etc.) Considere se a falta de um site √© realmente um problema para eles com base no que VOC√ä vende.'}\n\n2. ${isEn ? 'CUSTOMER PAIN POINTS: Based on reviews and business type, what frustrations do their customers likely face? What operational challenges does this business have?' : 'DORES DO CLIENTE: Com base nas avalia√ß√µes e tipo de neg√≥cio, quais frustra√ß√µes os clientes provavelmente enfrentam? Quais desafios operacionais este neg√≥cio tem?'}\n\n3. ${isEn ? 'SOCIAL MEDIA STRATEGY: Proactively analyze scenarios for Instagram, LinkedIn, and Facebook based on their niche. Suggest what kind of content they SHOULD be posting to get more clients. Be highly sincere about what they can improve.' : 'ESTRAT√âGIA DE REDES SOCIAIS: Analise proativamente cen√°rios para Instagram, LinkedIn e Facebook com base no nicho deles. Sugira que tipo de conte√∫do eles DEVERIAM postar para atrair mais clientes. Seja altamente sincero sobre o que eles podem melhorar.'}\n\n4. ${isEn ? 'FIRST CONTACT MESSAGE: Write a professional, personalized opening message for the FIRST contact (WhatsApp/email). It should reference something specific about this business (their rating, a review pattern, missing digital element). Max 3 short paragraphs. No generic templates.' : 'MENSAGEM DE PRIMEIRO CONTATO: Escreva uma mensagem de abertura profissional e personalizada para o PRIMEIRO contato (WhatsApp/email). Deve referenciar algo espec√≠fico deste neg√≥cio (avalia√ß√£o, padr√£o nas reviews, elemento digital faltando). M√°ximo 3 par√°grafos curtos. Sem templates gen√©ricos.'}\n5. ${isEn ? 'REVIEW RECENCY: Analyze the time of reviews. If reviews are mostly from years ago, flag this as a \"stagnant reputation\". If recent, analyze the trend.' : 'REC√äNCIA DE REVIEWS: Analise o tempo das avalia√ß√µes. Se forem majoritariamente de anos atr√°s, aponte isso como \"reputa√ß√£o estagnada\". Se recentes, analise a tend√™ncia.'}\n${isBusinessPlan ? (isEn ? '6. DEEP REPUTATION ANALYSIS: Using the REAL data from Reclame Aqui and JusBrasil provided in the web context above, analyze: (a) consumer reputation ‚Äî complaints, response rate, resolution rate; (b) legal risks ‚Äî lawsuits, labor disputes, consumer protection cases; (c) CNPJ data ‚Äî company size, founding date, business activities. Include ALL findings in the full report with source citations.' : '6. AN√ÅLISE PROFUNDA DE REPUTA√á√ÉO: Usando os dados REAIS do Reclame Aqui e JusBrasil fornecidos no contexto da web acima, analise: (a) reputa√ß√£o do consumidor ‚Äî reclama√ß√µes, taxa de resposta, taxa de resolu√ß√£o; (b) riscos legais ‚Äî processos, disputas trabalhistas, casos de defesa do consumidor; (c) dados de CNPJ ‚Äî porte da empresa, data de funda√ß√£o, atividades empresariais. Inclua TODOS os achados no relat√≥rio completo com cita√ß√µes de fonte.') : ''}\n7. ${isEn ? 'WHATSAPP MESSAGE: A shorter, more casual version for WhatsApp (max 2 short paragraphs, conversational tone, gets to the point fast).' : 'MENSAGEM WHATSAPP: Uma vers√£o mais curta e casual para WhatsApp (m√°ximo 2 par√°grafos curtos, tom conversacional, vai direto ao ponto).'}\n\n${isEn ? 'CRITICAL: Respond ONLY with valid JSON, no markdown, no code blocks. Values must be in ENGLISH:' : 'CR√çTICO: Responda APENAS com JSON v√°lido, sem markdown, sem blocos de c√≥digo. Valores devem estar em PORTUGU√äS:'}\n{\n  \"score\": <number 1-100>,\n  \"scoreLabel\": \"<${isEn ? 'Cold|Warm|Hot|Very Hot' : 'Frio|Morno|Quente|Muito Quente'}>\",\n  \"summary\": \"<${isEn ? 'Provide a dense executive summary specific to this business, without strict length constraints.' : 'Forne√ßa um denso resumo executivo espec√≠fico para este neg√≥cio, sem limite estrito de tamanho.'}>\",\n  \"strengths\": [\"<${isEn ? 'specific strength 1' : 'for√ßa espec√≠fica 1'}>\", \"<${isEn ? 'strength 2' : 'for√ßa 2'}>\", \"<${isEn ? 'strength 3' : 'for√ßa 3'}>\"],\n  \"weaknesses\": [\"<${isEn ? 'specific weakness 1' : 'fraqueza espec√≠fica 1'}>\", \"<${isEn ? 'weakness 2' : 'fraqueza 2'}>\", \"<${isEn ? 'weakness 3' : 'fraqueza 3'}>\"],\n  \"painPoints\": [\"<${isEn ? 'specific customer pain point 1' : 'dor espec√≠fica do cliente 1'}>\", \"<${isEn ? 'pain point 2' : 'dor 2'}>\", \"<${isEn ? 'pain point 3' : 'dor 3'}>\", \"<${isEn ? 'operational challenge 4' : 'desafio operacional 4'}>\"],\n  \"gaps\": [\"<${isEn ? 'digital gap 1: e.g. No website' : 'lacuna digital 1: ex. Sem website'}>\", \"<${isEn ? 'gap 2' : 'lacuna 2'}>\", \"<${isEn ? 'gap 3' : 'lacuna 3'}>\", \"<${isEn ? 'gap 4' : 'lacuna 4'}>\"],\n  \"approach\": \"<${isEn ? 'Specific approach strategy: what angle to use, what pain to address first, timing recommendations' : 'Estrat√©gia de abordagem espec√≠fica: qual √¢ngulo usar, qual dor abordar primeiro, recomenda√ß√µes de timing'}>\",\n  \"contactStrategy\": \"<${isEn ? 'Recommended channels (WhatsApp, LinkedIn, phone, email), best time to contact, who likely to answer, what to say first call' : 'Canais recomendados (WhatsApp, LinkedIn, telefone, email), melhor hor√°rio para contato, quem provavelmente atende, o que dizer na primeira liga√ß√£o'}>\",\n  \"firstContactMessage\": \"<${isEn ? 'Professional personalized opening message for first contact (email/WhatsApp), max 3 short paragraphs, specific to this business' : 'Mensagem de abertura profissional e personalizada para primeiro contato (email/WhatsApp), m√°ximo 3 par√°grafos curtos, espec√≠fica para este neg√≥cio'}>\",\n  \"suggestedWhatsAppMessage\": \"<${isEn ? 'Shorter casual WhatsApp version, 2 paragraphs max, conversational, direct' : 'Vers√£o mais curta e casual para WhatsApp, 2 par√°grafos no m√°ximo, conversacional, direta'}>\",\n  \"reviewAnalysis\": \"<${isEn ? 'Detailed analysis of the rating trend and recency' : 'An√°lise detalhada da tend√™ncia e rec√™ncia das avalia√ß√µes'}>\",\n  \"socialMedia\": {\n    \"instagram\": \"<${isEn ? 'CRITICAL: ONLY return real URLs. NEVER invent or hallucinate. If unsure, return Not found' : 'CR√çTICO: Retorne APENAS URLs reais. NUNCA invente ou alucine. Se n√£o tiver certeza absoluta, retorne exatamente N√£o encontrado'}>\",\n    \"facebook\": \"<${isEn ? 'CRITICAL: NEVER hallucinate URLs. If unsure, return Not found' : 'CR√çTICO: NUNCA alucine URLs. Se n√£o tiver certeza, retorne exatamente N√£o encontrado'}>\",\n    \"linkedin\": \"<${isEn ? 'CRITICAL: NEVER hallucinate URLs. If unsure, return Not found' : 'CR√çTICO: NUNCA alucine URLs. Se n√£o tiver certeza, retorne exatamente N√£o encontrado'}>\"\n  },\n  \"fullReport\": \"<${isEn\n            ? 'EXTREMELY DETAILED and extensive report in Markdown. Dive deep into all possibilities. Sections: ## Executive Summary | ## Digital Strategy | ## Deep Gaps | ## Operational Vulnerabilities | ## Competitor Profile | ## Complete Action Plan.'\n            : 'Relat√≥rio EXTREMAMENTE DETALHADO e extenso em Markdown. Aprofunde-se muito nas possibilidades, sem medo de gerar um texto grande. Se√ß√µes: ## Resumo Executivo | ## Estrat√©gia Digital | ## Lacunas Profundas | ## Vulnerabilidades Operacionais | ## Perfil do Concorrente | ## Plano de A√ß√£o Completo.'}>\"\n${isBusinessPlan ? `  ,\"reclameAquiAnalysis\": \"<${isEn ? 'Analysis of Reclame Aqui data: complaint patterns, response rate, resolution rate, overall reputation score. If no data found, state that clearly.' : 'An√°lise dos dados do Reclame Aqui: padr√µes de reclama√ß√£o, taxa de resposta, taxa de resolu√ß√£o, score geral de reputa√ß√£o. Se nenhum dado foi encontrado, declare isso claramente.'}>\"\n  ,\"jusBrasilAnalysis\": \"<${isEn ? 'Analysis of JusBrasil data: lawsuits, labor disputes, consumer cases, legal risks. If no data found, state that clearly.' : 'An√°lise dos dados do JusBrasil: processos, disputas trabalhistas, casos de consumidor, riscos legais. Se nenhum dado foi encontrado, declare isso claramente.'}>\"\n  ,\"cnpjAnalysis\": \"<${isEn ? 'Analysis of CNPJ data: company size, founding date, registered activities, tax status. If no data found, state that clearly.' : 'An√°lise dos dados de CNPJ: porte da empresa, data de funda√ß√£o, atividades registradas, situa√ß√£o fiscal. Se nenhum dado foi encontrado, declare isso claramente.'}>\"` : ''}\n}\n`;\n\n    try {\n        const { resolveAiForRole } = await import('@/lib/ai');\n        const { config } = await resolveAiForRole('lead_analysis');\n        const result = await generateCompletionForRole('lead_analysis', {\n            prompt,\n            jsonMode: true,\n            maxTokens: 8192,\n        });\n\n        // More robust JSON extraction\n        let cleaned = result.text;\n        const jsonMatch = result.text.match(/\\{[\\s\\S]*\\}/);\n        if (jsonMatch) {\n            cleaned = jsonMatch[0];\n        } else {\n            cleaned = result.text\n                .replace(/```json\\n?/g, '')\n                .replace(/```\\n?/g, '')\n                .trim();\n        }\n\n        const analysis = JSON.parse(cleaned) as LeadAnalysis;\n\n        // Persist Analysis in Background\n        saveAnalysisToDb(business.placeId, analysis, finalProfile, userId, context?.workspaceId).catch(err =>\n            import('@/lib/logger').then(({ logger }) => logger.error('Save analysis error', { error: err instanceof Error ? err.message : 'Unknown' }))\n        );\n\n        return { analysis, usage: result.usage, provider: config.provider };\n    } catch (error: unknown) {\n        const { logger } = await import('@/lib/logger');\n        logger.error('AI Analysis Error', { error: error instanceof Error ? error.message : 'Unknown' });\n\n        const err = error as { message?: string };\n        const msg = (err?.message ?? '').toLowerCase();\n        let errorMessage = 'N√£o foi poss√≠vel gerar an√°lise detalhada no momento.';\n        if (msg.includes('no ai config') || msg.includes('not set')) {\n            errorMessage = 'IA n√£o configurada. Configure um provedor em Admin ou GEMINI_API_KEY no servidor.';\n        } else if (msg.includes('403') || msg.includes('restriction') || msg.includes('permission')) {\n            errorMessage = 'API Key com restri√ß√£o (IP ou dom√≠nio). Verifique no painel do provedor.';\n        } else if (msg.includes('429') || msg.includes('quota') || msg.includes('rate limit')) {\n            errorMessage = 'Limite de uso da API atingido. Tente novamente em alguns minutos.';\n        } else if (msg.includes('401') || msg.includes('invalid') || msg.includes('api key')) {\n            errorMessage = 'Chave da API inv√°lida. Verifique a configura√ß√£o no admin.';\n        } else if (msg.includes('500') || msg.includes('unavailable')) {\n            errorMessage = 'Servi√ßo de IA temporariamente indispon√≠vel. Tente novamente em instantes.';\n        } else if (msg.includes('404') || msg.includes('no longer available') || msg.includes('newer model')) {\n            errorMessage = 'Modelo em uso n√£o est√° mais dispon√≠vel. Atualize o modelo na configura√ß√£o de IA.';\n        }\n\n        return {\n            analysis: {\n                score: 0,\n                scoreLabel: 'Indispon√≠vel',\n                summary: errorMessage,\n                strengths: [],\n                weaknesses: [],\n                painPoints: [],\n                gaps: [],\n                approach: 'Verifique a configura√ß√£o de IA no painel admin.',\n                contactStrategy: '',\n                firstContactMessage: '',\n                suggestedWhatsAppMessage: '',\n                fullReport: `# Erro\\n\\n${errorMessage}`,\n            },\n        };\n    }\n}\n\nasync function saveAnalysisToDb(placeId: string, analysis: LeadAnalysis, profile?: UserBusinessProfile, userId?: string, workspaceId?: string) {\n    try {\n        const lead = await prisma.lead.findUnique({ where: { placeId } });\n        if (!lead) return;\n\n        const finalUserId = userId || 'cl_guest_default';\n\n        if (!userId) {\n            await prisma.user.upsert({\n                where: { id: finalUserId },\n                update: {\n                    companyName: profile?.companyName,\n                    productService: profile?.productService,\n                    targetAudience: profile?.targetAudience,\n                    mainBenefit: profile?.mainBenefit,\n                },\n                create: {\n                    id: finalUserId,\n                    name: 'Guest User',\n                    companyName: profile?.companyName,\n                    productService: profile?.productService,\n                    targetAudience: profile?.targetAudience,\n                    mainBenefit: profile?.mainBenefit,\n                }\n            });\n        }\n\n        await prisma.leadAnalysis.create({\n            data: {\n                userId: finalUserId,\n                leadId: lead.id,\n                score: analysis.score,\n                scoreLabel: analysis.scoreLabel,\n                summary: analysis.summary,\n                strengths: analysis.strengths,\n                weaknesses: analysis.weaknesses,\n                painPoints: analysis.painPoints,\n                gaps: analysis.gaps,\n                status: 'NEW',\n                approach: analysis.approach,\n                contactStrategy: analysis.contactStrategy,\n                firstContactMessage: analysis.firstContactMessage,\n                suggestedWhatsAppMessage: analysis.suggestedWhatsAppMessage,\n                fullReport: analysis.fullReport,\n                socialInstagram: analysis.socialMedia?.instagram,\n                socialFacebook: analysis.socialMedia?.facebook,\n                socialLinkedin: analysis.socialMedia?.linkedin,\n            }\n        });\n\n        if (userId && userId !== 'cl_guest_default') {\n            const { createNotification } = await import('@/lib/notification-service');\n            const leadLink = `/dashboard/lead/${placeId}`;\n            void createNotification({\n                userId,\n                workspaceId: workspaceId ?? null,\n                title: 'Sua an√°lise est√° pronta',\n                message: 'A an√°lise do lead foi conclu√≠da. Clique para ver.',\n                type: 'INFO',\n                link: leadLink,\n                sendEmailIfPreferred: true,\n                emailSubject: 'Sua an√°lise est√° pronta',\n                channel: 'lead_analysis_ready',\n            }).catch((err) =>\n                import('@/lib/logger').then(({ logger }) => logger.error('Create notification after analysis', { error: err instanceof Error ? err.message : 'Unknown' }))\n            );\n        }\n    } catch (error) {\n        const msg = error instanceof Error ? error.message : 'Unknown';\n        if (typeof process !== 'undefined' && process.stderr) {\n            try {\n                const { logger } = await import('./logger');\n                logger.error('Error in saveAnalysisToDb', { error: msg });\n            } catch {\n                process.stderr.write(`saveAnalysisToDb error: ${msg}\\n`);\n            }\n        }\n    }\n}\n","import { AppRouteRouteModule } from \"next/dist/esm/server/route-modules/app-route/module.compiled\";\nimport { RouteKind } from \"next/dist/esm/server/route-kind\";\nimport { patchFetch as _patchFetch } from \"next/dist/esm/server/lib/patch-fetch\";\nimport { addRequestMeta, getRequestMeta } from \"next/dist/esm/server/request-meta\";\nimport { getTracer, SpanKind } from \"next/dist/esm/server/lib/trace/tracer\";\nimport { setManifestsSingleton } from \"next/dist/esm/server/app-render/manifests-singleton\";\nimport { normalizeAppPath } from \"next/dist/esm/shared/lib/router/utils/app-paths\";\nimport { NodeNextRequest, NodeNextResponse } from \"next/dist/esm/server/base-http/node\";\nimport { NextRequestAdapter, signalFromNodeResponse } from \"next/dist/esm/server/web/spec-extension/adapters/next-request\";\nimport { BaseServerSpan } from \"next/dist/esm/server/lib/trace/constants\";\nimport { getRevalidateReason } from \"next/dist/esm/server/instrumentation/utils\";\nimport { sendResponse } from \"next/dist/esm/server/send-response\";\nimport { fromNodeOutgoingHttpHeaders, toNodeOutgoingHttpHeaders } from \"next/dist/esm/server/web/utils\";\nimport { getCacheControlHeader } from \"next/dist/esm/server/lib/cache-control\";\nimport { INFINITE_CACHE, NEXT_CACHE_TAGS_HEADER } from \"next/dist/esm/lib/constants\";\nimport { NoFallbackError } from \"next/dist/esm/shared/lib/no-fallback-error.external\";\nimport { CachedRouteKind } from \"next/dist/esm/server/response-cache\";\nimport * as userland from \"INNER_APP_ROUTE\";\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new AppRouteRouteModule({\n    definition: {\n        kind: RouteKind.APP_ROUTE,\n        page: \"/api/v1/analyze/route\",\n        pathname: \"/api/v1/analyze\",\n        filename: \"route\",\n        bundlePath: \"\"\n    },\n    distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n    relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n    resolvedPagePath: \"[project]/backend/src/app/api/v1/analyze/route.ts\",\n    nextConfigOutput,\n    userland\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return _patchFetch({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\nexport { routeModule, workAsyncStorage, workUnitAsyncStorage, serverHooks, patchFetch,  };\nexport async function handler(req, res, ctx) {\n    if (routeModule.isDev) {\n        addRequestMeta(req, 'devRequestTimingInternalsEnd', process.hrtime.bigint());\n    }\n    let srcPage = \"/api/v1/analyze/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (process.env.TURBOPACK) {\n        srcPage = srcPage.replace(/\\/index$/, '') || '/';\n    } else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = process.env.__NEXT_MULTI_ZONE_DRAFT_MODE;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, parsedUrl, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname, clientReferenceManifest, serverActionsManifest } = prepareResult;\n    const normalizedSrcPage = normalizeAppPath(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    const render404 = async ()=>{\n        // TODO: should route-module itself handle rendering the 404\n        if (routerServerContext == null ? void 0 : routerServerContext.render404) {\n            await routerServerContext.render404(req, res, parsedUrl, false);\n        } else {\n            res.end('This page could not be found');\n        }\n        return null;\n    };\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                if (nextConfig.experimental.adapterPath) {\n                    return await render404();\n                }\n                throw new NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isStaticGeneration = isIsr && !supportsDynamicResponse;\n    // Before rendering (which initializes component tree modules), we have to\n    // set the reference manifests to our global store so Server Action's\n    // encryption util can access to them at the top level of the page module.\n    if (serverActionsManifest && clientReferenceManifest) {\n        setManifestsSingleton({\n            page: srcPage,\n            clientReferenceManifest,\n            serverActionsManifest\n        });\n    }\n    const method = req.method || 'GET';\n    const tracer = getTracer();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            cacheComponents: Boolean(nextConfig.cacheComponents),\n            supportsDynamicResponse,\n            incrementalCache: getRequestMeta(req, 'incrementalCache'),\n            cacheLifeProfiles: nextConfig.cacheLife,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext, silenceLog)=>routeModule.onRequestError(req, error, errorContext, silenceLog, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new NodeNextRequest(req);\n    const nodeNextRes = new NodeNextResponse(res);\n    const nextReq = NextRequestAdapter.fromNodeNextRequest(nodeNextReq, signalFromNodeResponse(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${srcPage}`);\n                }\n            });\n        };\n        const isMinimalMode = Boolean(process.env.MINIMAL_MODE || getRequestMeta(req, 'minimalMode'));\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!isMinimalMode && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = toNodeOutgoingHttpHeaders(response.headers);\n                        if (cacheTags) {\n                            headers[NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await sendResponse(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        const silenceLog = false;\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: getRevalidateReason({\n                                isStaticGeneration,\n                                isOnDemandRevalidate\n                            })\n                        }, silenceLog, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil,\n                isMinimalMode\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!isMinimalMode) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = fromNodeOutgoingHttpHeaders(cacheEntry.value.headers);\n            if (!(isMinimalMode && isIsr)) {\n                headers.delete(NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', getCacheControlHeader(cacheEntry.cacheControl));\n            }\n            await sendResponse(nodeNextReq, nodeNextRes, // @ts-expect-error - Argument of type 'Buffer<ArrayBufferLike>' is not assignable to parameter of type 'BodyInit | null | undefined'.\n            new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${srcPage}`,\n                    kind: SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        if (!(err instanceof NoFallbackError)) {\n            const silenceLog = false;\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: getRevalidateReason({\n                    isStaticGeneration,\n                    isOnDemandRevalidate\n                })\n            }, silenceLog, routerServerContext);\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await sendResponse(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n","import { NextRequest } from 'next/server';\nimport { analyzeLead, type BusinessData, type UserBusinessProfile } from '@/lib/gemini';\nimport { getOrCreateRequestId, jsonWithRequestId } from '@/lib/request-id';\nimport { v1AnalyzeSchema, formatZodError } from '@/lib/validations/schemas';\n\nexport async function POST(req: NextRequest) {\n    const requestId = getOrCreateRequestId(req);\n    try {\n        const body = await req.json();\n        const parsed = v1AnalyzeSchema.safeParse(body);\n        if (!parsed.success) {\n            return jsonWithRequestId({ error: formatZodError(parsed) }, { status: 400, requestId });\n        }\n        const { userProfile, locale, userId, ...businessData } = parsed.data;\n\n        const result = await analyzeLead(businessData as BusinessData, userProfile as UserBusinessProfile | undefined, locale || 'pt', userId);\n\n        return jsonWithRequestId(result.analysis, { requestId });\n    } catch (error) {\n        const { logger } = await import('@/lib/logger');\n        logger.error('V1 analyze error', { error: error instanceof Error ? error.message : 'Unknown' }, requestId);\n        return jsonWithRequestId({ error: 'Internal server error' }, { status: 500, requestId });\n    }\n}\n"],"names":[],"mappings":"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","ignoreList":[7]}