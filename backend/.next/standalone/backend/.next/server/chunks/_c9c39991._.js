module.exports=[24984,(e,t,r)=>{"use strict";var a=function(e,t){return t||(t={}),e.split("").forEach(function(e,r){e in t||(t[e]=r)}),t},o={alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",charmap:{0:14,1:8}};o.charmap=a(o.alphabet,o.charmap);var i={alphabet:"0123456789ABCDEFGHJKMNPQRSTVWXYZ",charmap:{O:0,I:1,L:1}};function n(e){if(this.buf=[],this.shift=8,this.carry=0,e){switch(e.type){case"rfc4648":this.charmap=r.rfc4648.charmap;break;case"crockford":this.charmap=r.crockford.charmap;break;default:throw Error("invalid type")}e.charmap&&(this.charmap=e.charmap)}}function s(e){if(this.buf="",this.shift=3,this.carry=0,e){switch(e.type){case"rfc4648":this.alphabet=r.rfc4648.alphabet;break;case"crockford":this.alphabet=r.crockford.alphabet;break;default:throw Error("invalid type")}e.alphabet?this.alphabet=e.alphabet:e.lc&&(this.alphabet=this.alphabet.toLowerCase())}}i.charmap=a(i.alphabet,i.charmap),n.prototype.charmap=o.charmap,n.prototype.write=function(e){var t=this.charmap,r=this.buf,a=this.shift,o=this.carry;return e.toUpperCase().split("").forEach(function(e){if("="!=e){var i=255&t[e];(a-=5)>0?o|=i<<a:a<0?(r.push(o|i>>-a),a+=8,o=i<<a&255):(r.push(o|i),a=8,o=0)}}),this.shift=a,this.carry=o,this},n.prototype.finalize=function(e){return e&&this.write(e),8!==this.shift&&0!==this.carry&&(this.buf.push(this.carry),this.shift=8,this.carry=0),this.buf},s.prototype.alphabet=o.alphabet,s.prototype.write=function(e){var t,r,a,o=this.shift,i=this.carry;for(a=0;a<e.length;a++)t=i|(r=e[a])>>o,this.buf+=this.alphabet[31&t],o>5&&(o-=5,t=r>>o,this.buf+=this.alphabet[31&t]),i=r<<(o=5-o),o=8-o;return this.shift=o,this.carry=i,this},s.prototype.finalize=function(e){return e&&this.write(e),3!==this.shift&&(this.buf+=this.alphabet[31&this.carry],this.shift=3,this.carry=0),this.buf},r.encode=function(e,t){return new s(t).finalize(e)},r.decode=function(e,t){return new n(t).finalize(e)},r.Decoder=n,r.Encoder=s,r.charmap=a,r.crockford=i,r.rfc4648=o},1789,(e,t,r)=>{"use strict";var a=e.r(24984),o=a.Decoder.prototype.finalize;a.Decoder.prototype.finalize=function(e){return new Buffer(o.call(this,e))},t.exports=a},17833,(e,t,r)=>{"use strict";var a=e.r(1789),o=e.r(54799),i=e.r(92509),n=e.r(24361);r.digest=function(e){var t,r=e.secret,i=e.counter,n=e.encoding||"ascii",s=(e.algorithm||"sha1").toLowerCase();null!=e.key&&(console.warn("Speakeasy - Deprecation Notice - Specifying the secret using `key` is no longer supported. Use `secret` instead."),r=e.key),Buffer.isBuffer(r)||(r="base32"===n?a.decode(r):new Buffer(r,n));var c=new Buffer(8),h=i;for(t=0;t<8;t++)c[7-t]=255&h,h>>=8;var p=o.createHmac(s,r);return p.update(c),p.digest()},r.hotp=function(e){var t=(null!=e.digits?e.digits:e.length)||6;null!=e.length&&console.warn("Speakeasy - Deprecation Notice - Specifying token digits using `length` is no longer supported. Use `digits` instead.");var a=e.digest||r.digest(e),o=15&a[a.length-1],i=(127&a[o])<<24|(255&a[o+1])<<16|(255&a[o+2])<<8|255&a[o+3];return(i=Array(t+1).join("0")+i.toString(10)).substr(-t)},r.counter=r.hotp,r.hotp.verifyDelta=function(e){var t,a=String((e=Object.create(e)).token),o=parseInt(e.digits,10)||6,i=parseInt(e.window,10)||0,n=parseInt(e.counter,10)||0;if(a.length===o&&!isNaN(a=parseInt(a,10))){for(t=n;t<=n+i;++t)if(e.counter=t,parseInt(r.hotp(e),10)===a)return{delta:t-n}}},r.hotp.verify=function(e){return null!=r.hotp.verifyDelta(e)},r._counter=function(e){var t=e.step||30,r=null!=e.time?1e3*e.time:Date.now(),a=(null!=e.epoch?1e3*e.epoch:1e3*e.initial_time)||0;return null!=e.initial_time&&console.warn("Speakeasy - Deprecation Notice - Specifying the epoch using `initial_time` is no longer supported. Use `epoch` instead."),Math.floor((r-a)/t/1e3)},r.totp=function(e){return null==(e=Object.create(e)).counter&&(e.counter=r._counter(e)),this.hotp(e)},r.time=r.totp,r.totp.verifyDelta=function(e){var t=parseInt((e=Object.create(e)).window,10)||0;null==e.counter&&(e.counter=r._counter(e)),e.counter-=t,e.window+=t;var a=r.hotp.verifyDelta(e);return a&&(a.delta-=t),a},r.totp.verify=function(e){return null!=r.totp.verifyDelta(e)},r.generateSecret=function(e){e||(e={});var t=e.length||32,o=encodeURIComponent(e.name||"SecretKey"),i=e.qr_codes||!1,n=e.google_auth_qr||!1,s=null==e.otpauth_url||e.otpauth_url,c=!0;void 0!==e.symbols&&!1===e.symbols&&(c=!1);var h=this.generateSecretASCII(t,c),p={};return p.ascii=h,p.hex=Buffer(h,"ascii").toString("hex"),p.base32=a.encode(Buffer(h)).toString().replace(/=/g,""),i&&(console.warn("Speakeasy - Deprecation Notice - generateSecret() QR codes are deprecated and no longer supported. Please use your own QR code implementation."),p.qr_code_ascii="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(p.ascii),p.qr_code_hex="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(p.hex),p.qr_code_base32="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(p.base32)),s&&(p.otpauth_url=r.otpauthURL({secret:p.ascii,label:o})),n&&(console.warn("Speakeasy - Deprecation Notice - generateSecret() Google Auth QR code is deprecated and no longer supported. Please use your own QR code implementation."),p.google_auth_qr="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(r.otpauthURL({secret:p.base32,label:o}))),p},r.generate_key=n.deprecate(function(e){return r.generateSecret(e)},"Speakeasy - Deprecation Notice - `generate_key()` is depreciated, please use `generateSecret()` instead."),r.generateSecretASCII=function(e,t){var r=o.randomBytes(e||32),a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";t&&(a+="!@#$%^&*()<>?/[]{},.:;");for(var i="",n=0,s=r.length;n<s;n++)i+=a[Math.floor(r[n]/255*(a.length-1))];return i},r.generate_key_ascii=n.deprecate(function(e,t){return r.generateSecretASCII(e,t)},"Speakeasy - Deprecation Notice - `generate_key_ascii()` is depreciated, please use `generateSecretASCII()` instead."),r.otpauthURL=function(e){var t=e.secret,r=e.label,o=e.issuer,n=(e.type||"totp").toLowerCase(),s=e.counter,c=e.algorithm,h=e.digits,p=e.period,u=e.encoding||"ascii";switch(n){case"totp":case"hotp":break;default:throw Error("Speakeasy - otpauthURL - Invalid type `"+n+"`; must be `hotp` or `totp`")}if(!t)throw Error("Speakeasy - otpauthURL - Missing secret");if(!r)throw Error("Speakeasy - otpauthURL - Missing label");if("hotp"===n&&null==s)throw Error("Speakeasy - otpauthURL - Missing counter value for HOTP");"base32"!==u&&(t=new Buffer(t,u)),Buffer.isBuffer(t)&&(t=a.encode(t));var l={secret:t};if(o&&(l.issuer=o),null!=c){switch(c.toUpperCase()){case"SHA1":case"SHA256":case"SHA512":break;default:console.warn("Speakeasy - otpauthURL - Warning - Algorithm generally should be SHA1, SHA256, or SHA512")}l.algorithm=c.toUpperCase()}if(null!=h){if(isNaN(h))throw Error("Speakeasy - otpauthURL - Invalid digits `"+h+"`");switch(parseInt(h,10)){case 6:case 8:break;default:console.warn("Speakeasy - otpauthURL - Warning - Digits generally should be either 6 or 8")}l.digits=h}if(null!=p){if(~~(p=parseInt(p,10))!==p)throw Error("Speakeasy - otpauthURL - Invalid period `"+p+"`");l.period=p}return i.format({protocol:"otpauth",slashes:!0,hostname:n,pathname:r,query:l})}},1231,e=>{"use strict";var t=e.i(17833);let r=process.env.TWOFA_ISSUER??"Prospector";function a(e){let a=t.default.generateSecret({name:`${r}:${e}`,length:20});return{secret:a.base32,otpauthUrl:a.otpauth_url??`otpauth://totp/${r}:${e}?secret=${a.base32}`}}function o(e,r){return t.default.totp.verify({secret:e,encoding:"base32",token:r,window:1})}e.s(["generateTotpSecret",()=>a,"verifyTotpToken",()=>o])}];

//# sourceMappingURL=_c9c39991._.js.map